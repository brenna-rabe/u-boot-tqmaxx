/*
 * Copyright (C) 2017 TQ-Systems GmbH (ported AM57xx IDK to TQMa57xx)
 *
 * Author: Stefan Lange <s.lange@gateware.de>
 *
 * SPDX-License-Identifier:     GPL-2.0+
 */

#include <asm/emif.h>

/*
 * DDR timings for TQMa57xx module variant with AM571x and 1GiB DRAM
 * DDR clock: 667 MHz
 */
static const struct emif_regs tqma571x_emif1_ddr3_666mhz_emif_regs = {
	.sdram_config_init = 0x61862B32,
	.sdram_config = 0x61862B32,
	.sdram_config2 = 0x00000000,
	.ref_ctrl = 0x1000514D,
	.ref_ctrl_final = 0x10000A25,
	.sdram_tim1 = 0xD11367EC,
	.sdram_tim2 = 0x30A87FE3,
	.sdram_tim3 = 0x407F8AD8,
	.read_idle_ctrl = 0x00050000,
	.zq_config = 0x5007190B,
	.temp_alert_config = 0x00000000,
	.emif_rd_wr_lvl_rmp_ctl = 0x00000000,
	.emif_rd_wr_lvl_ctl = 0x00000000,
	.emif_ddr_phy_ctlr_1_init = 0x0E24400E,
	.emif_ddr_phy_ctlr_1 = 0x0E24400E,
	.emif_rd_wr_exec_thresh = 0x00000305,

	.emif_ddr_ext_phy_ctrl_1 = 0x04040100,
	.emif_ddr_ext_phy_ctrl_2 = 0x006B00B0,
	.emif_ddr_ext_phy_ctrl_3 = 0x006B00B0,
	.emif_ddr_ext_phy_ctrl_4 = 0x006B00B5,
	.emif_ddr_ext_phy_ctrl_5 = 0x006B00B6
};

static const u32 tqma571x_emif1_ddr3_ext_phy_ctrl_const_regs[] = {
	0x04040100,	// EMIF1_EXT_PHY_CTRL_1
	0x006B00B0,	// EMIF1_EXT_PHY_CTRL_2
	0x006B00B0,	// EMIF1_EXT_PHY_CTRL_3
	0x006B00B5,	// EMIF1_EXT_PHY_CTRL_4
	0x006B00B6,	// EMIF1_EXT_PHY_CTRL_5
	0x006B00B9,	// EMIF1_EXT_PHY_CTRL_6
	0x002F002F,	// EMIF1_EXT_PHY_CTRL_7
	0x002F002F,	// EMIF1_EXT_PHY_CTRL_8
	0x002F002F,	// EMIF1_EXT_PHY_CTRL_9
	0x002F002F,	// EMIF1_EXT_PHY_CTRL_10
	0x002F002F,	// EMIF1_EXT_PHY_CTRL_11
	0x00600073,	// EMIF1_EXT_PHY_CTRL_12
	0x00600073,	// EMIF1_EXT_PHY_CTRL_13
	0x0060007F,	// EMIF1_EXT_PHY_CTRL_14
	0x0060007F,	// EMIF1_EXT_PHY_CTRL_15
	0x0060008C,	// EMIF1_EXT_PHY_CTRL_16
	0x00400053,	// EMIF1_EXT_PHY_CTRL_17
	0x00400053,	// EMIF1_EXT_PHY_CTRL_18
	0x0040005F,	// EMIF1_EXT_PHY_CTRL_19
	0x0040005F,	// EMIF1_EXT_PHY_CTRL_20
	0x0040006C,	// EMIF1_EXT_PHY_CTRL_21
	0x00800080,	// EMIF1_EXT_PHY_CTRL_22
	0x00800080,	// EMIF1_EXT_PHY_CTRL_23
	0x40010080,	// EMIF1_EXT_PHY_CTRL_24
	0x08102040,	// EMIF1_EXT_PHY_CTRL_25
	0x005B00A0,	// EMIF1_EXT_PHY_CTRL_26
	0x005B00A0,	// EMIF1_EXT_PHY_CTRL_27
	0x005B00A5,	// EMIF1_EXT_PHY_CTRL_28
	0x005B00A6,	// EMIF1_EXT_PHY_CTRL_29
	0x005B00A9,	// EMIF1_EXT_PHY_CTRL_30
	0x00300043,	// EMIF1_EXT_PHY_CTRL_31
	0x00300043,	// EMIF1_EXT_PHY_CTRL_32
	0x0030004F,	// EMIF1_EXT_PHY_CTRL_33
	0x0030004F,	// EMIF1_EXT_PHY_CTRL_34
	0x0030005C,	// EMIF1_EXT_PHY_CTRL_35
	0x00000077	// EMIF1_EXT_PHY_CTRL_36
};

/*
 * DDR timings for TQMa57xx module variant with AM572x and 2GiB DRAM
 * DDR clock: 532 MHz
 */
static const struct emif_regs tqma572x_emif1_ddr3_532mhz_emif_regs = {
	.sdram_config_init = 0x61851B32,
	.sdram_config = 0x61851B32,
	.sdram_config2 = 0x00000000,
	.ref_ctrl = 0x10004111,
	.ref_ctrl_final = 0x1000081E,
	.sdram_tim1 = 0xCCCF2663,
	.sdram_tim2 = 0x30867FDA,
	.sdram_tim3 = 0x407F88A8,
	.read_idle_ctrl = 0x00050000,
	.zq_config = 0x5007190B,
	.temp_alert_config = 0x00000000,
	.emif_rd_wr_lvl_rmp_ctl = 0x80000000,
	.emif_rd_wr_lvl_ctl = 0x00000000,
	.emif_ddr_phy_ctlr_1_init = 0x0024400B,
	.emif_ddr_phy_ctlr_1 = 0x0E24400B,
	.emif_rd_wr_exec_thresh = 0x00000305,

	.emif_ddr_ext_phy_ctrl_1 = 0x04040100,
	.emif_ddr_ext_phy_ctrl_2 = 0x006B006B,
	.emif_ddr_ext_phy_ctrl_3 = 0x006B006B,
	.emif_ddr_ext_phy_ctrl_4 = 0x006B006B,
	.emif_ddr_ext_phy_ctrl_5 = 0x006B006B
};

static const u32 tqma572x_emif1_ddr3_ext_phy_ctrl_const_regs[] = {
	0x04040100,	// EMIF1_EXT_PHY_CTRL_1
	0x006B006B,	// EMIF1_EXT_PHY_CTRL_2
	0x006B006B,	// EMIF1_EXT_PHY_CTRL_3
	0x006B006B,	// EMIF1_EXT_PHY_CTRL_4
	0x006B006B,	// EMIF1_EXT_PHY_CTRL_5
	0x006B006B,	// EMIF1_EXT_PHY_CTRL_6
	0x00320032,	// EMIF1_EXT_PHY_CTRL_7
	0x00320032,	// EMIF1_EXT_PHY_CTRL_8
	0x00320032,	// EMIF1_EXT_PHY_CTRL_9
	0x00320032,	// EMIF1_EXT_PHY_CTRL_10
	0x00320032,	// EMIF1_EXT_PHY_CTRL_11
	0x00600060,	// EMIF1_EXT_PHY_CTRL_12
	0x00600060,	// EMIF1_EXT_PHY_CTRL_13
	0x00600060,	// EMIF1_EXT_PHY_CTRL_14
	0x00600060,	// EMIF1_EXT_PHY_CTRL_15
	0x00600060,	// EMIF1_EXT_PHY_CTRL_16
	0x00400040,	// EMIF1_EXT_PHY_CTRL_17
	0x00400040,	// EMIF1_EXT_PHY_CTRL_18
	0x00400040,	// EMIF1_EXT_PHY_CTRL_19
	0x00400040,	// EMIF1_EXT_PHY_CTRL_20
	0x00400040,	// EMIF1_EXT_PHY_CTRL_21
	0x00800080,	// EMIF1_EXT_PHY_CTRL_22
	0x00800080,	// EMIF1_EXT_PHY_CTRL_23
	0x40010080,	// EMIF1_EXT_PHY_CTRL_24
	0x08102040,	// EMIF1_EXT_PHY_CTRL_25
	0x00000000,	// EMIF1_EXT_PHY_CTRL_26
	0x00000000,	// EMIF1_EXT_PHY_CTRL_27
	0x00000000,	// EMIF1_EXT_PHY_CTRL_28
	0x00000000,	// EMIF1_EXT_PHY_CTRL_29
	0x00000000,	// EMIF1_EXT_PHY_CTRL_30
	0x00000000,	// EMIF1_EXT_PHY_CTRL_31
	0x00000000,	// EMIF1_EXT_PHY_CTRL_32
	0x00000000,	// EMIF1_EXT_PHY_CTRL_33
	0x00000000,	// EMIF1_EXT_PHY_CTRL_34
	0x00000000,	// EMIF1_EXT_PHY_CTRL_35
	0x00000077	// EMIF1_EXT_PHY_CTRL_36
};

static const struct emif_regs tqma572x_emif2_ddr3_532mhz_emif_regs = {
	.sdram_config_init = 0x61851B32,
	.sdram_config = 0x61851B32,
	.sdram_config2 = 0x00000000,
	.ref_ctrl = 0x10004111,
	.ref_ctrl_final = 0x1000081E,
	.sdram_tim1 = 0xCCCF2663,
	.sdram_tim2 = 0x30867FDA,
	.sdram_tim3 = 0x407F88A8,
	.read_idle_ctrl = 0x00050000,
	.zq_config = 0x5007190B,
	.temp_alert_config = 0x00000000,
	.emif_rd_wr_lvl_rmp_ctl = 0x80000000,
	.emif_rd_wr_lvl_ctl = 0x00000000,
	.emif_ddr_phy_ctlr_1_init = 0x0024400B,
	.emif_ddr_phy_ctlr_1 = 0x0E24400B,
	.emif_rd_wr_exec_thresh = 0x00000305,

	.emif_ddr_ext_phy_ctrl_1 = 0x04040100,
	.emif_ddr_ext_phy_ctrl_2 = 0x006B006B,
	.emif_ddr_ext_phy_ctrl_3 = 0x006B006B,
	.emif_ddr_ext_phy_ctrl_4 = 0x006B006B,
	.emif_ddr_ext_phy_ctrl_5 = 0x006B006B
};

static const u32 tqma572x_emif2_ddr3_ext_phy_ctrl_const_regs[] = {
	0x04040100,	// EMIF2_EXT_PHY_CTRL_1
	0x006B006B,	// EMIF2_EXT_PHY_CTRL_2
	0x006B006B,	// EMIF2_EXT_PHY_CTRL_3
	0x006B006B,	// EMIF2_EXT_PHY_CTRL_4
	0x006B006B,	// EMIF2_EXT_PHY_CTRL_5
	0x006B006B,	// EMIF2_EXT_PHY_CTRL_6
	0x00320032,	// EMIF2_EXT_PHY_CTRL_7
	0x00320032,	// EMIF2_EXT_PHY_CTRL_8
	0x00320032,	// EMIF2_EXT_PHY_CTRL_9
	0x00320032,	// EMIF2_EXT_PHY_CTRL_10
	0x00320032,	// EMIF2_EXT_PHY_CTRL_11
	0x00600060,	// EMIF2_EXT_PHY_CTRL_12
	0x00600060,	// EMIF2_EXT_PHY_CTRL_13
	0x00600060,	// EMIF2_EXT_PHY_CTRL_14
	0x00600060,	// EMIF2_EXT_PHY_CTRL_15
	0x00600060,	// EMIF2_EXT_PHY_CTRL_16
	0x00400040,	// EMIF2_EXT_PHY_CTRL_17
	0x00400040,	// EMIF2_EXT_PHY_CTRL_18
	0x00400040,	// EMIF2_EXT_PHY_CTRL_19
	0x00400040,	// EMIF2_EXT_PHY_CTRL_20
	0x00400040,	// EMIF2_EXT_PHY_CTRL_21
	0x00800080,	// EMIF2_EXT_PHY_CTRL_22
	0x00800080,	// EMIF2_EXT_PHY_CTRL_23
	0x40010080,	// EMIF2_EXT_PHY_CTRL_24
	0x08102040,	// EMIF2_EXT_PHY_CTRL_25
	0x00000000,	// EMIF2_EXT_PHY_CTRL_26
	0x00000000,	// EMIF2_EXT_PHY_CTRL_27
	0x00000000,	// EMIF2_EXT_PHY_CTRL_28
	0x00000000,	// EMIF2_EXT_PHY_CTRL_29
	0x00000000,	// EMIF2_EXT_PHY_CTRL_30
	0x00000000,	// EMIF2_EXT_PHY_CTRL_31
	0x00000000,	// EMIF2_EXT_PHY_CTRL_32
	0x00000000,	// EMIF2_EXT_PHY_CTRL_33
	0x00000000,	// EMIF2_EXT_PHY_CTRL_34
	0x00000000,	// EMIF2_EXT_PHY_CTRL_35
	0x00000077	// EMIF2_EXT_PHY_CTRL_36
};

/*
 * DDR timings for TQMa57xx module variant with AM574x and 2GiB DRAM + ECC
 * DDR clock: 666 MHz
 */
static const struct emif_regs tqma574x_emif1_ddr3_666mhz_emif_regs = {
	.sdram_config_init = 0x61862B32,
	.sdram_config = 0x61862B32,
	.sdram_config2 = 0x00000000,
	.ref_ctrl = 0x1000514D,
	.ref_ctrl_final = 0x10000A25,
	.sdram_tim1 = 0xD11367EC,
	.sdram_tim2 = 0x30B37FE3,
	.sdram_tim3 = 0x407F8AD8,
	.read_idle_ctrl = 0x00050000,
	.zq_config = 0x5007190B,
	.temp_alert_config = 0x00000000,
	.emif_rd_wr_lvl_rmp_ctl = 0x80000000,
	.emif_rd_wr_lvl_ctl = 0x00000000,
	.emif_ddr_phy_ctlr_1_init = 0x0024400E,
	.emif_ddr_phy_ctlr_1 = 0x0E24400E,
	.emif_rd_wr_exec_thresh = 0x00000305,
#if CONFIG_TQMA57XX_ECC
	.emif_ecc_ctrl_reg = 0xD0000001,
	.emif_ecc_address_range_1 = 0x1EFF0000,
	.emif_ecc_address_range_2 = 0x00000000,
#endif
	.emif_ddr_ext_phy_ctrl_1 = 0x04040100,
	.emif_ddr_ext_phy_ctrl_2 = 0x006B006B,
	.emif_ddr_ext_phy_ctrl_3 = 0x006B006B,
	.emif_ddr_ext_phy_ctrl_4 = 0x006B006B,
	.emif_ddr_ext_phy_ctrl_5 = 0x006B006B
};

static const u32 tqma574x_emif1_ddr3_ext_phy_ctrl_const_regs[] = {
	0x04040100,	// EMIF1_EXT_PHY_CTRL_1
	0x006B006B,	// EMIF1_EXT_PHY_CTRL_2
	0x006B006B,	// EMIF1_EXT_PHY_CTRL_3
	0x006B006B,	// EMIF1_EXT_PHY_CTRL_4
	0x006B006B,	// EMIF1_EXT_PHY_CTRL_5
	0x006B006B,	// EMIF1_EXT_PHY_CTRL_6
	0x002F002F,	// EMIF1_EXT_PHY_CTRL_7
	0x002F002F,	// EMIF1_EXT_PHY_CTRL_8
	0x002F002F,	// EMIF1_EXT_PHY_CTRL_9
	0x002F002F,	// EMIF1_EXT_PHY_CTRL_10
	0x002F002F,	// EMIF1_EXT_PHY_CTRL_11
	0x00600060,	// EMIF1_EXT_PHY_CTRL_12
	0x00600060,	// EMIF1_EXT_PHY_CTRL_13
	0x00600060,	// EMIF1_EXT_PHY_CTRL_14
	0x00600060,	// EMIF1_EXT_PHY_CTRL_15
	0x00600060,	// EMIF1_EXT_PHY_CTRL_16
	0x00400040,	// EMIF1_EXT_PHY_CTRL_17
	0x00400040,	// EMIF1_EXT_PHY_CTRL_18
	0x00400040,	// EMIF1_EXT_PHY_CTRL_19
	0x00400040,	// EMIF1_EXT_PHY_CTRL_20
	0x00400040,	// EMIF1_EXT_PHY_CTRL_21
	0x00800080,	// EMIF1_EXT_PHY_CTRL_22
	0x00800080,	// EMIF1_EXT_PHY_CTRL_23
	0x40010080,	// EMIF1_EXT_PHY_CTRL_24
	0x08102040,	// EMIF1_EXT_PHY_CTRL_25
	0x00000000,	// EMIF1_EXT_PHY_CTRL_26
	0x00000000,	// EMIF1_EXT_PHY_CTRL_27
	0x00000000,	// EMIF1_EXT_PHY_CTRL_28
	0x00000000,	// EMIF1_EXT_PHY_CTRL_29
	0x00000000,	// EMIF1_EXT_PHY_CTRL_30
	0x00000000,	// EMIF1_EXT_PHY_CTRL_31
	0x00000000,	// EMIF1_EXT_PHY_CTRL_32
	0x00000000,	// EMIF1_EXT_PHY_CTRL_33
	0x00000000,	// EMIF1_EXT_PHY_CTRL_34
	0x00000000,	// EMIF1_EXT_PHY_CTRL_35
	0x00000077	// EMIF1_EXT_PHY_CTRL_36
};

static const struct emif_regs tqma574x_emif2_ddr3_666mhz_emif_regs = {
	.sdram_config_init = 0x61862B32,
	.sdram_config = 0x61862B32,
	.sdram_config2 = 0x00000000,
	.ref_ctrl = 0x1000514D,
	.ref_ctrl_final = 0x10000A25,
	.sdram_tim1 = 0xD11367EC,
	.sdram_tim2 = 0x30B37FE3,
	.sdram_tim3 = 0x407F8AD8,
	.read_idle_ctrl = 0x00050000,
	.zq_config = 0x5007190B,
	.temp_alert_config = 0x00000000,
	.emif_rd_wr_lvl_rmp_ctl = 0x80000000,
	.emif_rd_wr_lvl_ctl = 0x00000000,
	.emif_ddr_phy_ctlr_1_init = 0x0024400E,
	.emif_ddr_phy_ctlr_1 = 0x0E24400E,
	.emif_rd_wr_exec_thresh = 0x00000305,

	.emif_ddr_ext_phy_ctrl_1 = 0x04040100,
	.emif_ddr_ext_phy_ctrl_2 = 0x006B00A7,
	.emif_ddr_ext_phy_ctrl_3 = 0x006B00A6,
	.emif_ddr_ext_phy_ctrl_4 = 0x006B009B,
	.emif_ddr_ext_phy_ctrl_5 = 0x006B0099
};

static const u32 tqma574x_emif2_ddr3_ext_phy_ctrl_const_regs[] = {
	0x04040100,	// EMIF2_EXT_PHY_CTRL_1
	0x006B006B,	// EMIF2_EXT_PHY_CTRL_2
	0x006B006B,	// EMIF2_EXT_PHY_CTRL_3
	0x006B006B,	// EMIF2_EXT_PHY_CTRL_4
	0x006B006B,	// EMIF2_EXT_PHY_CTRL_5
	0x006B006B,	// EMIF2_EXT_PHY_CTRL_6
	0x002F002F,	// EMIF2_EXT_PHY_CTRL_7
	0x002F002F,	// EMIF2_EXT_PHY_CTRL_8
	0x002F002F,	// EMIF2_EXT_PHY_CTRL_9
	0x002F002F,	// EMIF2_EXT_PHY_CTRL_10
	0x002F002F,	// EMIF2_EXT_PHY_CTRL_11
	0x00600060,	// EMIF2_EXT_PHY_CTRL_12
	0x00600060,	// EMIF2_EXT_PHY_CTRL_13
	0x00600060,	// EMIF2_EXT_PHY_CTRL_14
	0x00600060,	// EMIF2_EXT_PHY_CTRL_15
	0x00600060,	// EMIF2_EXT_PHY_CTRL_16
	0x00400040,	// EMIF2_EXT_PHY_CTRL_17
	0x00400040,	// EMIF2_EXT_PHY_CTRL_18
	0x00400040,	// EMIF2_EXT_PHY_CTRL_19
	0x00400040,	// EMIF2_EXT_PHY_CTRL_20
	0x00400040,	// EMIF2_EXT_PHY_CTRL_21
	0x00800080,	// EMIF2_EXT_PHY_CTRL_22
	0x00800080,	// EMIF2_EXT_PHY_CTRL_23
	0x40010080,	// EMIF2_EXT_PHY_CTRL_24
	0x08102040,	// EMIF2_EXT_PHY_CTRL_25
	0x00000000,	// EMIF2_EXT_PHY_CTRL_26
	0x00000000,	// EMIF2_EXT_PHY_CTRL_27
	0x00000000,	// EMIF2_EXT_PHY_CTRL_28
	0x00000000,	// EMIF2_EXT_PHY_CTRL_29
	0x00000000,	// EMIF2_EXT_PHY_CTRL_30
	0x00000000,	// EMIF2_EXT_PHY_CTRL_31
	0x00000000,	// EMIF2_EXT_PHY_CTRL_32
	0x00000000,	// EMIF2_EXT_PHY_CTRL_33
	0x00000000,	// EMIF2_EXT_PHY_CTRL_34
	0x00000000,	// EMIF2_EXT_PHY_CTRL_35
	0x00000077	// EMIF2_EXT_PHY_CTRL_36
};
