if TARGET_TQMA8MXML || TARGET_TQMA8MXNL

config SYS_BOARD
	default "tqma8mxml"

config SYS_VENDOR
	default "tqc"

config SYS_CONFIG_NAME
	default "tqma8mxml"

choice
	prompt "TQMa8MMX HW revision"
	default TQMA8MMX_HWREV_0200

config TQMA8MMX_HWREV_0100
	bool "TQMa8MMx hardware revision 010x"
	help
	  Select hardware revision 010x

config TQMA8MMX_HWREV_0200
	bool "TQMa8MMx hardware revision 020x"
	help
	  Select hardware revision 020x

endchoice

choice
	prompt "TQMa8MMX RAM size"
	default TQMA8MMX_RAM_1024MB if IMX8MN
	default TQMA8MMX_RAM_1024MB if IMX8MM && TQMA8MMX_HWREV_0100
	default TQMA8MMX_RAM_2048MB if IMX8MM && TQMA8MMX_HWREV_0200
	help
	  Select RAM size for TQMa8MMx

config TQMA8MMX_RAM_1024MB
	bool "TQMa8MMx with 1024 MiB RAM"
	help
	  Select variant with 1024 MiB RAM

config TQMA8MMX_RAM_2048MB
	bool "TQMa8MMx with 2048 MiB RAM"
	help
	  Select variant with 2048 MiB RAM

endchoice

choice
	prompt "TQMa8MXX base board variant"
	default TQMA8MXX_BB_MBA8MX
	help
	  Select base board for TQMa8MxML/TQMa8MxNL

config TQMA8MXX_BB_MBA8MX
	bool "TQMa8MxML/TQMa8MxNL on MBa8Mx Starterkit"
	select TQC_SDMMC
	select TQC_ENVLOC if !IMX8MN
	select ENV_DEFAULT_NOWHERE
	select CMD_FUSE
	select MII
	select CMD_MII
	select CMD_PING
	select CMD_DHCP
	select CMD_NET
	select DM_ETH
	select FEC_MXC
	select PHYLIB
	select PHY_GIGE
	select PHY_TI
	help
	  Select the MBa8Mx starterkit. This features a GigE Phy, USB, SD-Card
	  etc.

endchoice

config DEFAULT_DEVICE_TREE
	default "fsl-imx8mn-mba8mx" if TQMA8MXX_BB_MBA8MX && IMX8MN && TQMA8MMX_HWREV_0200
	default "fsl-imx8mm-mba8mx" if TQMA8MXX_BB_MBA8MX && IMX8MM && TQMA8MMX_HWREV_0200
	default "fsl-imx8mn-mba8mx-r0100" if TQMA8MXX_BB_MBA8MX && IMX8MN && TQMA8MMX_HWREV_0100
	default "fsl-imx8mm-mba8mx-r0100" if TQMA8MXX_BB_MBA8MX && IMX8MM && TQMA8MMX_HWREV_0100

config DEFAULT_FDT_FILE
	default "imx8mn-mba8mx.dtb" if TQMA8MXX_BB_MBA8MX && IMX8MN && TQMA8MMX_HWREV_0200
	default "imx8mm-mba8mx.dtb" if TQMA8MXX_BB_MBA8MX && IMX8MM && TQMA8MMX_HWREV_0200
	default "imx8mn-mba8mx-r0100.dtb" if TQMA8MXX_BB_MBA8MX && IMX8MN && TQMA8MMX_HWREV_0100
	default "imx8mm-mba8mx-r0100.dtb" if TQMA8MXX_BB_MBA8MX && IMX8MM && TQMA8MMX_HWREV_0100

config NR_DRAM_BANKS
	default 1

config SYS_TEXT_BASE
	default 0x40200000

config SYS_MALLOC_F_LEN
	default 0x2000

#
# even if this is the Kconfig default in the memory controller Kconfig for
# i.MX8M, we set this here for completeness. This value is hard coded in the
# TF-A port (imx-atf) for i.MXMM / i.MXNN
#
config SAVED_DRAM_TIMING_BASE
	default 0x180000 if IMX8MM
	default 0x180000 if IMX8MN

config FIT_EXTERNAL_OFFSET
	default 0x3000

config SPL_FIT_GENERATOR
	default "arch/arm/mach-imx/mkimage_fit_atf.sh"

#
# TODO: delete as soon as SPL_TEXT_BASE is moved to Kconfig
# Attention: i.MX8MM has different settings for SPL_TEXT_BASE depending on boot
# device
#
config SYS_EXTRA_OPTIONS
	default "IMX_CONFIG=arch/arm/mach-imx/imx8m/imximage.cfg,SPL_TEXT_BASE=0x912000" if IMX8MN

menu "TQMa8MXX boot device"

config TQMA8MXX_BOOT_SDCARD
	bool "TQMa8MxML/TQMa8MxNL boot from SD / e-MMC"
	default "y" if IMX8MN
	select SD_BOOT
	select ENV_IS_IN_MMC
	help
	  Select booting from SD / e-MMC

config TQMA8MXX_BOOT_FSPI
	bool "TQMa8MxML/TQMa8MxNL boot from FlexSPI"
	default "y" if IMX8MN
	select QSPI_BOOT
	select ENV_IS_IN_SPI_FLASH
	help
	  Select booting from FlexSPI

endmenu

config TQMA8MXX_DEFAULTS
	bool
	default y
	select ARCH_MISC_INIT
	select TQC_EEPROM
	select TQC_RTC
	select BOARD_LATE_INIT
	select BOARD_EARLY_INIT_F
	select FIT
	select OF_CONTROL
	select OF_BOARD_SETUP
	select OF_SYSTEM_SETUP
	select PINCTRL
	select PINCTRL_IMX8M
	select DM
	select DM_MMC
	select MMC_IO_VOLTAGE
	select MMC_HS400_SUPPORT
	select FSL_ESDHC
	select DM_THERMAL
	select DM_SERIAL
	select MXC_UART
	select DM_GPIO
	select MXC_GPIO
	select DM_I2C
	select SYS_I2C_MXC
	select MISC
	select FSL_FSPI
	select DM_SPI
	select SPI
	select DM_SPI
	select SPI_FLASH_MTD
	select MTD_DEVICE
	select DM_SPI_FLASH
	select SPI_FLASH
	select SPI_FLASH_4BYTES_ADDR
	select SPI_FLASH_MACRONIX
	select SPI_FLASH_SPANSION
	select SPI_FLASH_STMICRO
	select SPI_FLASH_SST
	select SPI_FLASH_WINBOND
	select SPL
	select SPL_LOAD_FIT
	select SPL_BOARD_INIT
	select SPL_ENV_SUPPORT
	select SPL_SERIAL_SUPPORT
	select SPL_GPIO_SUPPORT
	select SPL_MMC_SUPPORT
	select SPL_DRIVERS_MISC_SUPPORT
	select SPL_POWER_SUPPORT
	select SPL_I2C_SUPPORT
	select SPL_LIBGENERIC_SUPPORT
	select SPL_LIBCOMMON_SUPPORT
	select SPL_NOR_SUPPORT
	select SPL_MTD_SUPPORT
	select SPL_SPI_FLASH_SUPPORT
	select SPL_SPI_FLASH_TINY
	select SPL_SPI_SUPPORT
	select SPL_SPI_LOAD

#
# default values for FLEXSPI NOR. Will be used also for environment from FLEXSPI
# if ENV_SPI_[BUS,CS,MODE,SPEED] are not used to overwrite.
#

config SF_DEFAULT_BUS
	default 0

config SF_DEFAULT_CS
	default 0

config SF_DEFAULT_SPEED
	default 40000000

config SF_DEFAULT_MODE
	default 0

#
# environment settings: 32k, offset 4M (SPI NOR sector 64k), redundant env
# in SPI NOR @ 4M + 64k
#
# These should go here, when updating U-Boot to newer Version
#

config TQMA8MXX_MFG_SUPPORT
	bool "MFG Tool support"
	select USB
	select DM_USB
	select USB_GADGET
	select DM_USB_GADGET
	select CI_UDC
	select USB_EHCI_HCD
	select MXC_USB_OTG_HACTIVE
	select USB_FUNCTION_SDP
	select USB_FUNCTION_FASTBOOT
	select FASTBOOT_UUU_SUPPORT
	select FASTBOOT_FLASH
	select CMD_FASTBOOT
	select SPL_USB_HOST_SUPPORT
	select SPL_USB_GADGET
	select SPL_USB_SDP_SUPPORT
	select SPL_IMX_ROMAPI_SUPPORT if TARGET_TQMA8MXNL

if TQMA8MXX_MFG_SUPPORT

config USB_GADGET_MANUFACTURER
	default "FSL"

config USB_GADGET_VENDOR_NUM
	default 0x0525

config USB_GADGET_PRODUCT_NUM
	default 0xa4a5

config USB_GADGET_VBUS_DRAW
	default 2

config SDP_LOADADDR
	default 0x40400000

config FASTBOOT_BUF_ADDR
	default 0x42800000

config SPL_IMX_ROMAPI_LOADADDR
	default 0x48000000 if TARGET_TQMA8MXNL

# restrict to 256M
config FASTBOOT_BUF_SIZE
	default 0x10000000

config FASTBOOT_USB_DEV
	default 0 if TQMA8MXX_BB_MBA8MX

endif

source "board/tqc/common/Kconfig"

endif
